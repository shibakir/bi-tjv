<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Pridat Anekdot</title>
    <link href="/css/main.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
    <body style="background-color: #fac9c9; margin-top: 5%; margin-left: 20%; margin-right: 20%">

        <div class="global">
            <h1 style="text-align: center">Pridani vaseho anekdotu</h1>
            <form action="#" th:action="@{/memes/add}" th:object="${memeWebModel}" method="post">
                <div class="form-group">
                    <label><h3 style="margin-bottom: 2%;">Nazev:</h3></label>
                    <input type="text" id="name" name="name" th:field="*{name}" class="form-control" required oninput="checkName()"/><br/>
                </div>
                <div class="form-group" style="margin-bottom: 2%;">
                    <label><h3 style="margin-bottom: 2%;">Obsah anekdotu:</h3></label>
                    <textarea id="pathName" name="path_name" th:field="*{path_name}" class="form-control" required oninput="checkLength()"></textarea>
                    <small id="lengthMessage" class="form-text text-danger"></small>
                </div>
                <input type="submit" class="btn btn-primary" id="submitButton" disabled/>
            </form>
            <div th:if="${error}" class="alert alert-danger" role="alert">
                <span th:text="${error}"></span>
            </div>
            <a class="global hrefs btn btn-primary mt-3" href="/memes">Vsechny anekdoty</a>
        </div>

        <script>
            function checkLength() {
                var maxLength = 255;
                var textarea = document.getElementById('pathName');
                var lengthMessage = document.getElementById('lengthMessage');
                var submitButton = document.getElementById('submitButton');

                if (textarea.value.length > maxLength) {
                    lengthMessage.textContent = 'Text length exceeds the limit of ' + maxLength + ' characters.';
                    submitButton.disabled = true;
                } else {
                    lengthMessage.textContent = '';
                    submitButton.disabled = false;
                }
            }

            function checkName() {
                var nameInput = document.getElementById('name');
                var lengthMessage = document.getElementById('lengthMessage');
                var submitButton = document.getElementById('submitButton');

                if (nameInput.value.trim() === '') {
                    lengthMessage.textContent = 'Nazev is required.';
                    submitButton.disabled = true;
                } else {
                    lengthMessage.textContent = '';
                    submitButton.disabled = false;
                }
            }
        </script>
    </body>
</html>